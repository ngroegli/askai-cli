# AskAI CLI - AI Service Integration Architecture
title: "AI Service Integration Architecture"


app_layer: "Application Layer" {
  style.fill: "#E3F2FD" # Light Blue (group)

  ai_service: "AI Service" {style.fill: "#90CAF9"} # Light Blue (node)
  model_config: "Model Configuration" {style.fill: "#90CAF9"}
}


# Client Layer
client_layer: "Client Layer" {
  style.fill: "#F3E5F5" # Light Purple (group)

  openrouter: "OpenRouter Client" {style.fill: "#CE93D8"} # Light Purple (node)
  web_search: "Web Search Plugin" {style.fill: "#CE93D8"}
  multimodal: "Multimodal Handler" {style.fill: "#CE93D8"}
}


# External Services
external: "External Services" {
  style.fill: "#FFF3E0" # Light Orange (group)

  openrouter_api: "OpenRouter API" {style.fill: "#FFCC80"} # Light Orange (node)
  ai_models: "AI Models" {style.fill: "#FFCC80"}
  web_services: "Web Services" {style.fill: "#FFCC80"}
}


# Message Processing
message_proc: "Message Processing" {
  style.fill: "#E8F5E9" # Light Green (group)

  builder: "Message Builder" {style.fill: "#A5D6A7"} # Light Green (node)
  encoder: "Content Encoder" {style.fill: "#A5D6A7"}
  formatter: "Format Handler" {style.fill: "#A5D6A7"}
}


# Response Processing
response_proc: "Response Processing" {
  style.fill: "#E8F5E9" # Light Green (group)

  parser: "Response Parser" {style.fill: "#A5D6A7"} # Light Green (node)
  extractor: "Content Extractor" {style.fill: "#A5D6A7"}
  validator: "Response Validator" {style.fill: "#A5D6A7"}
}

# Connections
app_layer -> message_proc: "Build Messages"
message_proc -> client_layer: "Formatted Messages"
client_layer -> external: "API Requests"
external -> client_layer: "API Responses"
client_layer -> response_proc: "Raw Responses"
response_proc -> app_layer: "Processed Results"

# Internal flows
app_layer.ai_service -> app_layer.model_config: "Configure"
app_layer.model_config -> client_layer.openrouter: "Model Settings"

client_layer.web_search -> external.web_services: "Search Queries"
client_layer.multimodal -> external.ai_models: "Multimodal Content"

message_proc.builder -> message_proc.encoder: "Content"
message_proc.encoder -> message_proc.formatter: "Encoded Content"

response_proc.parser -> response_proc.extractor: "Parsed Data"
response_proc.extractor -> response_proc.validator: "Extracted Content"
